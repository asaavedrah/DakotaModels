{"version":3,"file":"ngx-highlight-js.umd.js","sources":["../../lib/src/highlight-js.directive.ts","../../lib/src/highlight-js.module.ts","../../lib/ngx-highlight-js.ts"],"names":["Directive","ElementRef","NgModel","Optional","Inject","DOCUMENT","Input","NgModule","FormsModule"],"mappings":"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","sourcesContent":["import {\n  Directive,\n  ElementRef,\n  Input,\n  OnInit,\n  OnDestroy,\n  AfterViewInit,\n  Inject,\n  Optional,\n} from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { NgModel } from '@angular/forms';\nimport { Subscription } from 'rxjs';\n\ndeclare const hljs: any;\n\n@Directive({\n  selector: '[highlight-js]',\n  host: {\n    style: 'display:none;',\n  },\n  exportAs: 'highlightJs',\n})\nexport class HighlightJsDirective implements OnInit, AfterViewInit, OnDestroy {\n  constructor(\n    private el: ElementRef<HTMLElement>,\n    @Optional() private ngModel: NgModel,\n    @Inject(DOCUMENT) private doc: any,\n  ) {}\n  @Input() options: any;\n  @Input() lang = 'html';\n  @Input() code: string;\n\n  protected codeEl: HTMLElement;\n  protected parentEl: HTMLElement;\n  private modelValue$: Subscription;\n\n  // #region Mutation\n\n  private observer: MutationObserver;\n\n  private escapeHTML(str: string): string {\n    return (str || '')\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&apos;');\n  }\n\n  private init(): void {\n    this.destroy();\n    this.codeEl = this.doc.createElement('pre');\n    if (this.lang) {\n      this.codeEl.className = this.lang;\n    }\n    this.codeEl.innerHTML =\n      this.code || '' + this.el.nativeElement.innerHTML.trim();\n    this.parentEl = this.el.nativeElement.parentNode as HTMLElement;\n    this.parentEl.insertBefore(this.codeEl, this.el.nativeElement.nextSibling);\n\n    hljs.configure({ ...this.options });\n    hljs.highlightBlock(this.codeEl);\n  }\n\n  private destroy(): void {\n    if (this.codeEl) {\n      this.parentEl.removeChild(this.codeEl);\n      this.codeEl = null;\n    }\n  }\n\n  ngOnInit(): void {\n    this.init();\n  }\n\n  ngAfterViewInit(): void {\n    if (this.ngModel) {\n      this.modelValue$ = this.ngModel.valueChanges.subscribe((res) => {\n        this.code = this.escapeHTML(res);\n        this.init();\n      });\n    } else {\n      this.initMutation();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.destroy();\n    this.destroyMutation();\n    if (this.modelValue$) {\n      this.modelValue$.unsubscribe();\n    }\n  }\n\n  private initMutation(): void {\n    if (typeof MutationObserver === 'undefined') {\n      return;\n    }\n    this.observer = new MutationObserver(this.init.bind(this));\n    this.observer.observe(this.el.nativeElement, {\n      characterData: true,\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  private destroyMutation(): void {\n    if (!this.observer) {\n      return;\n    }\n    this.observer.disconnect();\n  }\n\n  // #endregionn\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HighlightJsDirective } from './highlight-js.directive';\n\n@NgModule({\n  imports: [FormsModule],\n  declarations: [HighlightJsDirective],\n  exports: [HighlightJsDirective],\n})\nexport class HighlightJsModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"]}